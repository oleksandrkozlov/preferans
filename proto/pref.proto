syntax = "proto3";

package pref;

message PPlayer {
  string player_id = 1;
  string player_name = 2;
}

message JoinRequest {
  string player_name = 1;
  optional string player_id = 2;
}

message JoinResponse {
  string player_id = 1;
  repeated PPlayer players = 2;
}

message PlayerJoined {
  string player_id = 1;
  string player_name = 2;
}

message PlayerLeft {
  string player_id = 1;
}

message DealCards {
  repeated string cards = 1;
}

message PlayCard {
  string player_id = 1;
  string card = 2; // e.g. "queen_of_hearts"
}

message PlayerTurn {
  string player_id = 1;
  string stage = 2; // Bidding, TalonPicking, Playing, Whisting
  repeated string talon = 3; // queen_of_hearts, etc.
}

message Bidding {
    string player_id = 1;
    string bid = 2; // e.g., "8â™ ", "PASS", "MISER", etc.
}

message Whisting {
    string player_id = 1;
    string choice = 2; // e.g., "Whist", "Half-Whist", "Pass", etc.
}

message DiscardTalon {
    string player_id = 1;
    repeated string cards = 2; // queen_of_hearts, etc.
    string bid = 3;
}

message Tricks {
  string player_id = 1;
  int32 taken = 2;
}

message TrickFinished {
  repeated Tricks tricks = 1;
}

message IntSeries {
  repeated sint32 values = 1;
}

message ScoreData {
  IntSeries dump = 1;
  IntSeries pool = 2;
  map<string /*player_id*/, IntSeries> whists = 3;
}

message DealFinished {
  map<string /*player_id*/, ScoreData> score_sheet = 1;
}

message Message {
  string method = 1;
  bytes payload = 2;
}
